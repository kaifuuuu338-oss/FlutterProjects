{% extends 'base.html' %}
{% block title %}Supervisor Dashboard{% endblock %}
{% block content %}
<section class="section">
  <div class="section-header"><h2>{{ title }}</h2><span class="tag">Role: Supervisor</span></div>
  <form class="filter-row" method="get">
    <label>Sector ID<input type="text" name="location_id" value="{{ location_id }}" placeholder="SEC001"></label>
    <button class="btn primary" type="submit">Apply</button>
  </form>
  {% if alerts %}
    <div class="alerts-wrap">{% for a in alerts %}<div class="alert-line">{{ a.level|upper }}: {{ a.message }}</div>{% endfor %}</div>
  {% endif %}
  <div class="stat-grid">
    <div class="stat-card"><div><div class="stat-value">{{ total_children }}</div><div class="stat-label">Children in Sector</div></div></div>
    <div class="stat-card"><div><div class="stat-value">{{ referral_completion }}%</div><div class="stat-label">Referral Completion</div></div></div>
    <div class="stat-card"><div><div class="stat-value">{{ followup_compliance }}%</div><div class="stat-label">Follow-up Compliance</div></div></div>
    <div class="stat-card"><div><div class="stat-value">{{ underperforming_awcs|length }}</div><div class="stat-label">Underperforming AWCs</div></div></div>
  </div>
</section>
<section class="section">
  <div class="section-header"><h2>AWC Comparison</h2></div>
  <div class="table-wrap">
    <table class="kpi-table">
      <thead><tr><th>AWC</th><th>Total</th><th>High Risk</th><th>Coverage %</th><th>Referral %</th><th>Score</th><th>Status</th></tr></thead>
      <tbody>
        {% for row in aww_performance %}
          <tr>
            <td>{{ row.awc_id }}</td>
            <td>{{ row.total_children }}</td>
            <td>{{ row.high_risk_children }}</td>
            <td>{{ row.screening_coverage }}</td>
            <td>{{ row.referral_completion_rate }}</td>
            <td>{{ row.performance_score }}</td>
            <td>{% if row.underperforming %}Needs Support{% else %}On Track{% endif %}</td>
          </tr>
        {% empty %}
          <tr><td colspan="7">No AWC data.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
